<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Venice Local</title>
  <link rel="manifest" href="manifest.json">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Authentication flow (signup/signin/guest) -->
  <div id="auth-screen" class="screen">
    <div class="auth-container">
      <div class="auth-intro">
        <div class="auth-logo" aria-label="Venice Local">
          <img class="veniceLogo" alt="Venice Local logo">
          <span class="sr-only">Venice Local</span>
        </div>
        <h1>Venice Local</h1>
        <p class="muted">Discover and support small businesses in downtown Venice, Florida. Sign in to review, save favorite businesses, and discover deals.</p>
        <ul class="feature-list">
          <li>Find local gems by category and rating</li>
          <li>Leave trusted reviews with human verification</li>
          <li>Save favorites and redeem hometown deals</li>
        </ul>
      </div>
      <div class="auth-forms">
        <div class="card" id="auth-choice-card">
          <h2>Get started with Venice Local!</h2>
          <p class="muted">You can browse as a guest or create an account/sign in to save favorites and post reviews.</p>
          <div class="choice-buttons">
            <button id="start-create-btn" class="primary-btn">Create Account</button>
            <button id="start-signin-btn" class="secondary-btn">Sign In</button>
            <button id="guest-btn" class="ghost-btn">Continue as Guest</button>
          </div>
        </div>
        <div class="card hidden" id="signup-card">
          <h2>Create Account</h2>
          <form id="signup-form">
            <label>Display Name<input type="text" id="signup-name" required></label>
            <label>Email<input type="email" id="signup-email" required></label>
            <label>Password<input type="password" id="signup-password" required></label>
            <label>Profile Picture (URL)<input type="url" id="signup-avatar" placeholder="https://example.com/photo.jpg"></label>
            <label>Profile Picture (Upload)<input type="file" id="signup-avatar-file" accept="image/*"></label>
            <label>Role
              <select id="signup-role" required>
                <option value="">Select role</option>
                <option value="owner">Business Owner</option>
                <option value="patron">Local Customer</option>
              </select>
            </label>
            <div class="verification">
              <label><input type="checkbox" id="signup-human"> I'm not a robot</label>
              <label class="challenge-label">
                <span>Type the word: <strong>VENICE</strong></span>
                <input type="text" id="signup-challenge" placeholder="VENICE" required>
              </label>
            </div>
            <button type="submit" class="primary-btn">Create Account</button>
            <p class="error" id="signup-error"></p>
            <button type="button" class="link-btn" data-auth-back>← Back to options</button>
          </form>
        </div>
        <div class="card hidden" id="signin-card">
          <h2>Sign In</h2>
          <form id="signin-form">
            <label>Email<input type="email" id="signin-email" required></label>
            <label>Password<input type="password" id="signin-password" required></label>
            <label>What is 2 + 3? (bot check)
              <input type="number" id="signin-math" placeholder="5" required>
            </label>
            <button type="submit" class="secondary-btn">Sign In</button>
            <p class="error" id="signin-error"></p>
            <button type="button" class="link-btn" data-auth-back>← Back to options</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Main application shell after login -->
  <div id="app-screen" class="screen hidden">
    <header class="topbar">
      <div class="topbar-left">
        <div class="brand" aria-label="Venice Local">
          <img class="veniceLogo" alt="Venice Local logo">
          <span class="sr-only">Venice Local</span>
        </div>
        <nav class="nav-actions">
          <button class="nav-btn" data-target="list">All Businesses</button>
          <button class="nav-btn" data-target="favorites">My Favorites</button>
          <button class="nav-btn owner-only" data-target="owner">Owner Dashboard</button>
          <button class="nav-btn owner-only" data-target="add">Add My Business</button>
          <button class="nav-btn" id="logout-btn">Logout</button>
        </nav>
      </div>
      <div class="profile-actions">
        <button class="nav-btn" data-target="profile">Profile</button>
        <button class="avatar-chip" type="button" data-target="profile">
          <img id="topbar-avatar" alt="Profile avatar">
        </button>
      </div>
    </header>

    <main class="content">
      <!-- Browse all businesses -->
      <section id="list-section" class="view-section">
        <div class="filters card">
          <div class="filter-group">
            <label>Search
              <input type="text" id="search-input" placeholder="Search by name or keyword">
            </label>
            <label>Category
              <select id="category-filter">
                <option value="all">All</option>
                <option value="Food">Food</option>
                <option value="Retail">Retail</option>
                <option value="Services">Services</option>
                <option value="Wellness">Wellness</option>
                <option value="Entertainment">Entertainment</option>
              </select>
            </label>
            <label>Sort by
              <select id="sort-select">
                <option value="rating">Highest Rating</option>
                <option value="reviews">Most Reviewed</option>
                <option value="alpha">Alphabetical</option>
              </select>
            </label>
          </div>
          <div id="role-note" class="muted"></div>
          <p id="business-load-error" class="error small"></p>
        </div>
        <div id="business-list" class="card-grid"></div>
        <p id="empty-list" class="empty-text hidden">No businesses found. Be the first to add one!</p>
      </section>

      <!-- Saved favorites -->
      <section id="favorites-section" class="view-section hidden">
        <div class="section-header">
          <h2>My Favorites</h2>
          <p class="muted">Saved local spots you love.</p>
        </div>
        <div id="favorites-list" class="card-grid"></div>
        <p id="empty-favorites" class="empty-text hidden">You haven’t saved any local businesses yet.</p>
      </section>

      <!-- Owner add/edit form -->
      <section id="add-section" class="view-section hidden">
        <div class="card form-card">
          <h2>Add My Business</h2>
          <form id="add-business-form">
            <label>Business Name<input type="text" id="business-name" required></label>
            <label>Category
              <select id="business-category" required>
                <option value="Food">Food</option>
                <option value="Retail">Retail</option>
                <option value="Services">Services</option>
                <option value="Wellness">Wellness</option>
                <option value="Entertainment">Entertainment</option>
              </select>
            </label>
            <label>Address (Downtown Venice, FL)<input type="text" id="business-address" placeholder="e.g., 200 Main St, Venice, FL" required></label>
            <label>Description<textarea id="business-description" rows="3" required></textarea></label>
            <label>Hours<input type="text" id="business-hours" placeholder="Mon-Fri 8a-6p" required></label>
            <label class="checkbox-inline">
              <input type="checkbox" id="has-deals"> Add a special deal?
            </label>
            <label>Special Deals / Coupons<textarea id="business-deals" rows="2" placeholder="10% off for locals" disabled></textarea></label>
            <div class="photo-inputs">
              <label>Business Photo (URL)<input type="url" id="business-photo-url" placeholder="https://example.com/storefront.jpg"></label>
              <label>Business Photo (Upload)<input type="file" id="business-photo-file" accept="image/*"></label>
              <p class="muted small">Add one clear storefront photo. URL or upload; upload is recommended.</p>
            </div>
            <button type="submit" class="primary-btn">Save Business</button>
            <p class="error" id="add-error"></p>
            <p class="success" id="add-success"></p>
          </form>
        </div>
      </section>

      <!-- Owner dashboard metrics -->
      <section id="owner-section" class="view-section hidden">
        <div class="section-header">
          <h2>Owner Dashboard</h2>
          <p class="muted">Track performance and update your businesses.</p>
        </div>
        <div class="dashboard-grid">
          <div class="card stat-card">
            <p class="muted">My Businesses</p>
            <h3 id="stat-count-businesses">0</h3>
          </div>
          <div class="card stat-card">
            <p class="muted">Total Reviews</p>
            <h3 id="stat-count-reviews">0</h3>
          </div>
          <div class="card stat-card">
            <p class="muted">Avg Rating</p>
            <h3 id="stat-avg-rating">0.0</h3>
          </div>
          <div class="card stat-card">
            <p class="muted">Active Deals</p>
            <h3 id="stat-count-deals">0</h3>
          </div>
        </div>

        <div class="card">
          <div class="dashboard-header">
            <div>
              <h3>My Businesses</h3>
              <p class="muted small">Quickly edit details or post a new deal.</p>
            </div>
            <button class="secondary-btn owner-only" data-target="add">+ Add Business</button>
          </div>
          <div id="owner-business-list" class="owner-list"></div>
          <p id="owner-empty" class="empty-text hidden">No businesses yet. Add your first business to get started.</p>
        </div>
      </section>

      <!-- Profile drawer -->
      <section id="profile-section" class="view-section hidden">
        <div class="card">
          <div class="profile-avatar">
            <div class="avatar-frame">
              <img id="profile-avatar" alt="Profile picture">
            </div>
            <div>
              <h2>Account Settings</h2>
            </div>
          </div>
          <p><strong>Display Name:</strong> <span id="profile-name"></span></p>
          <p><strong>Email:</strong> <span id="profile-email"></span></p>
          <p><strong>Role:</strong> <span id="profile-role"></span></p>
          <form id="profile-photo-form" class="profile-photo-form">
            <label>Profile Picture (URL)<input type="url" id="profile-avatar-url" placeholder="https://example.com/photo.jpg"></label>
            <label>Profile Picture (Upload)<input type="file" id="profile-avatar-file" accept="image/*"></label>
            <button type="submit" class="secondary-btn">Update Photo</button>
            <p class="error" id="profile-avatar-error"></p>
            <p class="success" id="profile-avatar-success"></p>
          </form>
          <p class="muted">Sign in or create an account to leave reviews or add businesses.</p>
        </div>
      </section>
    </main>
  </div>

  <!-- Business detail modal -->
  <div id="detail-modal" class="modal hidden">
    <div class="modal-content">
      <button class="close-btn" id="close-detail">×</button>
      <div id="detail-body"></div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
